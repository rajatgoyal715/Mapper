var keyInput,valueInput,spanMessage,addButton,itemsList;function getSelection(){chrome.tabs.executeScript({code:"window.getSelection().toString()"},function(e){e&&e[0]&&(valueInput.value=e[0].replace(/\n/g," "))})}function addItem(){var e=keyInput.value;if(e){var t=valueInput.value;t?addPair(e,t,function(){message("New pair added successfully")}):message("Error: No value specified")}else message("Error: No key specified")}function addPair(e,t,n){console.log("key:",e),console.log("value:",t),getPairs(function(a){pairs=a.map,console.log(pairs),pairs[e]=t,console.log(pairs),setPairs(pairs,n)})}function getPairs(e){chrome.storage.sync.get(["map"],e)}function setPairs(e,t){chrome.storage.sync.set({map:e},t)}function message(e){spanMessage.textContent=e,spanMessage.style.visibility="visible",setTimeout(function(){spanMessage.style.visibility="hidden"},2e3)}function deleteItem(){var e=this.parentNode.querySelector(".key").textContent;getPairs(function(t){var n={};for(var a in t.map)t.map.hasOwnProperty(a)&&a!==e&&(n[a]=t.map[a]);setPairs(n,function(){message(e+" successfully removed")})})}function copyItemValueToClipboard(){navigator.clipboard.writeText(this.parentNode.querySelector(".value").textContent).then(function(){message("Value copied to clipboard.")}).catch(function(){message("Failed to copy value to clipboard.")})}function populateList(e){var t,n,a,o,i,s,c,l,d,u;itemsList.innerHTML="";for(var r in e)n=e[t=r],(i=document.createElement("img")).src="../images/delete_16.png",(s=document.createElement("button")).appendChild(i),s.onclick=deleteItem,(c=document.createElement("span")).className="key",c.textContent=t,(l=document.createElement("span")).className="value",l.textContent=n,(d=document.createElement("img")).src="../images/copy_16.png",(u=document.createElement("button")).appendChild(d),u.onclick=copyItemValueToClipboard,(o=document.createElement("DIV")).className="itemDiv",o.appendChild(s),o.appendChild(c),o.appendChild(l),o.appendChild(u),(a=document.createElement("li")).appendChild(o),itemsList.appendChild(a),console.log("key:",r," value:",e[r])}function loadPairs(){getPairs(function(e){populateList(e.map)})}window.onload=function(){(keyInput=this.document.getElementById("keyInput")).textContent="",keyInput.addEventListener("keyup",function(e){e.preventDefault(),13===e.keyCode&&addItem()}),(valueInput=this.document.getElementById("valueInput")).textContent="",valueInput.addEventListener("keyup",function(e){e.preventDefault(),13===e.keyCode&&addItem()}),(addButton=this.document.getElementById("addItem")).onclick=addItem,(spanMessage=this.document.getElementById("message")).textContent="",itemsList=this.document.getElementById("itemsList"),loadPairs(),getSelection()},chrome.storage.onChanged.addListener(function(e,t){console.log("storage on changed"),loadPairs()});